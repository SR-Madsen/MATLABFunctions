%% Steinmetz Coefficients from Magnetic Design Tool
clear, close all, clc;

% Transformer
x_trafo = [0.04981397271599839, 0.06196775527077309, 0.074844977263332, 0.08786688714344776, 0.09987598181066559, 0.11275320380322451, 0.12505167424555608, 0.13778420835055816, 0.1500826787928897];
y_trafo = [47.73301542861616, 73.31905448705652, 115.26312962170755, 183.31657832405185, 278.33123323329363, 351.0084821766569, 437.5578659378697, 539.1574322099227, 679.9410534556955];

% Curve fitting
% cftool
% Pv = f(B)
% X data = x, Y data = y
% equation = Kc/(2^(beta-1)*pi^(alpha-1)*(1.1044+6.8244/(alpha+1.354)))*B^beta*200000^alpha
% Minimum values are 0. Start at 0.01, 1.5, and 2.5. (Kc, alpha, beta)
Kc = 0.009498;
alpha = 1.424;
beta = 2.383;

Ki = Kc/(2^(beta-1)*pi^(alpha-1)*(1.1044+6.8244/(alpha+1.354)));


% Inductor
x_inductor = [0.0251844843897824, 0.030066225165562913, 0.03682119205298014, 0.04, 0.04556291390728477, 0.05010406811731315, 0.055212866603595076, 0.060094607379375595];
y_inductor = [101.40971902431353, 129.86301527453273, 183.42074010187906, 214.9563809284016, 284.4080796485318, 359.14370085949787, 422.86007273234884, 493.2556331717184];

x_inductor = [0.025542857142857145, 0.03011428571428572, 0.037142857142857144, 0.04, 0.045657142857142854, 0.050057142857142856, 0.056114285714285714, 0.06011428571428571, 0.06565714285714286, ...
    0.07, 0.07554285714285713, 0.08005714285714285, 0.08554285714285714, 0.09125714285714286, 0.09714285714285713, 0.09982857142857143];
y_inductor = [49.57462402563962, 65.16251436121381, 100.74816986785365, 119.52222479355056, 169.66108859476628, 221.11086244191299,  271.4337719661929, 308.5478389392706, 372.3532613170807 ...
    426.89823994801804,  515.1776542711506, 595.7126118918844, 718.9015959671589, 867.5651553570356, 1055.9548008054492, 1150.140986846771];

% Curve fitting
% cftool

% Dataset 1 (D = 0.4615)
%Kc_l = 0.03749;
%alpha_l = 1.344;
%beta_l = 1.956;

% Dataset 2 (D = 0.923)
Kc_l = 0.009836;
alpha_l = 1.475;
beta_l = 2.592;

Ki = Kc/(2^(beta-1)*pi^(alpha-1)*(1.1044+6.8244/(alpha+1.354)));