	function [K,MAG,GT,ZL,ZLabs,ZLang,ZS,ZSabs,ZSang] = spmatch(r11,v11,r12,v12,r21,v21,r22,v22)	%	%[K,MAG,GT,ZL,ZLabs,ZLang,ZS,ZSabs,ZSang] = spmatch(r11,v11,r12,v12,r21,v21,r22,v22)	%	%INPUT:	%r11: abs. S11, v11: vinkel af S11 i grader, etc.	%	%OUTPUT (litt. 7):	%K: Rollent Stability Factor	%MAG: Maximun Available Gain	%GT: Tranducer Gain	%ZL Belastningsimpedans (rektangulaer form)	%ZLabs: Absolut vaerdi af belatningsimpedans	%ZLang: Vinkel vaerdi (grader) af belatningsimpedans	%ZS Kildesimpedans (rektangulaer form)	%ZSabs: Absolut vaerdi af kildeimpedans	%ZSang: Vinkel vaerdi (grader) af kildeimpedans	%sl@tek.sdu.dk	%	s11=r11*cos(v11/180*pi)+j*r11*sin(v11/180*pi);	s12=r12*cos(v12/180*pi)+j*r12*sin(v12/180*pi);	s21=r21*cos(v21/180*pi)+j*r21*sin(v21/180*pi);	s22=r22*cos(v22/180*pi)+j*r22*sin(v22/180*pi);	DS=s11*s22-s12*s21;	C2=s22-(DS*conj(s11));	K=(1+(abs(DS))^2-(abs(s11))^2-(abs(s22))^2)/(2*abs(s21)*abs(s12));	B1=1+(abs(s11))^2-(abs(s22))^2-(abs(DS))^2;	B2=1+(abs(s22))^2-(abs(s11))^2-(abs(DS))^2;	MAG=10*log10(abs(s21)/abs(s12))+10*log10(abs(K-sign(B1)*sqrt(K^2-1)));	ZLabs=(B2-sign(B2)*sqrt(B2^2-4*(abs(C2))^2))/(2*abs(C2));	ZLangrad=-angle(C2);	ZLang=-angle(C2)/pi*180;	ZL=ZLabs*cos(ZLangrad)+j*ZLabs*sin(ZLangrad);	ZSconj=(s11+(s12*s21*ZL)/(1-ZL*s22));	%ZSabs=abs(s11+(s12*s21*ZL)/(1-ZL*s22));	ZSabs=abs(ZSconj);	%ZSangrad=-angle(s11+(s12*s21*RL)/(1-RL*s22))	ZSangrad=-angle(ZSconj);	ZSang=ZSangrad/pi*180;	ZS=ZSabs*cos(ZSangrad)+j*ZLabs*sin(ZSangrad);	T=(abs(s21)^2)*(1-(abs(ZS))^2)*(1-(abs(ZL))^2);	N=abs((1-s11*ZS)*(1-s22*ZL)-s12*s21*ZL*ZS)^2	GT=10*log10(T/N);	%GT=10*log10((abs(s21))^2*(1-(abs(RS))^2)*(1-(abs(RL))^2)/abs((1-s11*RL)*(1-s22*RL)-s12*s21*RL*RS)^2);